import pandas as pd
import numpy as np

df = pd.DataFrame({'RowInd':[1,2,3,4,5,1,2,3,4,5,1,2,3,4,5],
                  'Time' : [0,0,0,0,0,60,60,60,60,60,120,120,120,120,120],
                  'ColInd':[10, 10, 10, 20, 10, 30, 30,
                           30, 30, 30, 30, 20, 20, 20, 
                           20],
                   'geometry':[1000, 1000, 1000, 2000, 1000, 3000, 3000,
                           3000, 3000, 3000, 3000, 2000, 2000, 2000, 
                           2000]})

print(df)
df_max = df.groupby(['RowInd'])['ColInd'].agg(
        [('ColIndMax', 'max')])
print(df_max)
df_max2 = pd.merge(df[["RowInd","geometry","ColInd"]],
                   df_max,
                   left_on = ["RowInd","ColInd"],
                   right_on = ["RowInd","ColIndMax"],
                   how = "right")

print(df_max2)

# Group by geometry
df_max3 = df_max2.drop_duplicates()
print(df_max3)
# Drop duplicates
df_max3 = df_max3.drop_duplicates()
print(df_max3)

"""
#df_max["CustomerName"] = df_max.index
print(df_max)
merged = pd.merge(df[["CustomerName","Year","Sales"]],
                        df_max[["SalesMax"]],
                        left_on = ["CustomerName","Sales"],
                        right_on = ["CustomerName","SalesMax"],
                        how= "right")
print("merged")
print(merged)"""